Web3大学雏形
1.合约开发者部署平台YD代币 开发课程相关合约
2.创建课程作者创建课程制定课程价格
3.购买课程 并进行课程授权
4.创建课程作者将YD币兑换为ETH再兑换为USDT质押进AAVE进行理财
https://aave.com/docs/resources/addresses
5.用户个人中心 通过MetaMask的签名机制 实现名称修改+安全的获取已经购买的课程详情

（ETH兑换成USDT部分为选修哈 先别自己开发 有精力的同学可以自己搞）
兑换地址：https://uniswap-testnet.sourcehat.io/#/swap
USDT合约地址：0xaA8E23Fb1079EA71e0a56F48a2aA51851D8433D0


### **Web3 大学：一个去中心化知识经济体的白皮书与技术实现方案**

**版本：2.1 日期：2025 年 9 月 3 日**

### **摘要**

本文档旨在全面阐述“Web3 大学”项目的愿景、架构、功能、经济模型及发展路线图。Web3 大学是一个基于区块链技术的去中心化在线教育平台，致力于通过 Web3 技术重塑知识的创造、所有权和价值分配，构建一个公平、透明且由创作者和学习者共同驱动的知识经济体。我们将采用 Web2+Web3 混合架构，优先实现核心的“创建-购买-学习”价值闭环（MVP），并规划了清晰的未来生态扩展路径。

---

### **1. 项目愿景与目标 (Vision & Goals)**

**1.1 愿景**
我们预见一个未来：知识的传播不再受制于中心化平台的垄断和高昂抽成。每一位知识创作者都能自主地为自己的内容定价，并获得与其贡献相匹配的直接回报；每一位学习者的教育投资都有可验证的、永久的链上记录。“Web3 大学”将成为这个未来愿景的先行者和基础设施。

**1.2 核心目标**

- **第一阶段 (核心 MVP)**: 我们的首要目标是快速构建并验证平台的核心价值主张。我们将集中资源打造一个功能完整、体验流畅的基础产品，让创作者可以无缝发布课程并售出，学习者可以顺利地使用加密货币购买并安全地访问课程内容。
- **后续阶段 (生态扩展)**: 在核心 MVP 得到市场验证后，我们将逐步引入为创作者设计的金融工具（如资产回兑、DeFi 理财），并增加社区治理（DAO）、链上证书（NFT）等功能，构建一个可持续、可自循环的经济和学习生态系统。

---

### **2. 系统概述与核心架构 (System Overview & Core Architecture)**

Web3 大学采用经过深思熟虑的**Web2+Web3 混合架构**，以求在去中心化的信任与中心化服务的高性能之间取得最佳平衡。

```
+-------------------------------------------------------------------------+
|                               用户 (浏览器)                             |
+-------------------------------------------------------------------------+
      |                           ^           | (React/TS/Ethers.js/Wagmi)
(钱包交互, 交易签名)             |      (课程内容, 页面渲染)
      v                           |           v
+------------------------+      +-----------------------------------------+
|   区块链 (以太坊网络)  |      |         Web2 后端服务 (Node.js)         |
|------------------------|      |-----------------------------------------|
| - YDToken 合约         |      | - API 接口 (Express.js)                 |
| - CoursePlatform 合约  | <--> | - 权限验证模块                          |
+------------------------+      | - 数据库 (PostgreSQL) -> (存储课程详情) |
      ^                           |                                         |
      | (监听事件)                | (GraphQL 查询权限)                      |
      |                           v                                         |
+------------------------+                                                  |
| The Graph (索引服务)   |                                                  |
+------------------------+                                                  |

```

- **链上信任层 (On-Chain Trust Layer)**: 由以太坊网络上的智能合约构成，负责处理所有与**资产**（YD 代币）和**所有权**（课程购买记录）相关的核心逻辑，确保过程的公开、透明与不可篡改。
- **链下体验层 (Off-Chain Experience Layer)**: 由高性能的 Web2 后端服务和现代化的前端应用构成，负责处理**课程内容存储**、**用户界面交互**和**高性能数据查询**，确保用户体验的流畅与友好。

---

### **3. 功能模块详述 (Functional Modules)**

我们将功能模块明确划分为两个阶段，以保证开发焦点。

### **3.1 核心功能模块 (MVP)**

- **用户与钱包系统**:
  - `钱包连接`: 支持 MetaMask 等主流浏览器钱包的一键式安全登录。
  - `用户信息展示`: 动态显示用户的公开地址、ENS 域名（若有）、ETH 余额和平台代币（YD）余额。
- **基础经济系统**:
  - `ETH兑换YD币`: 提供一个由智能合约驱动的单向兑换通道，确保新用户可以便捷地获取平台代币，以参与经济活动。
- **课程市场**:
  - `课程列表`: 通过 The Graph 高效查询并展示所有在链上注册的课程。
  - `课程详情`: 展示由创作者提交的、存储在后端数据库中的详细课程介绍。
  - `课程购买流程`: 实现一个安全、用户友好的两步购买流程（Approve & Purchase），所有交易均在链上完成。
- **作者平台**:
  - `课程创建与发布`: 提供基础的表单和工具，让作者能够填写课程信息（标题、描述、价格等），并成功将课程发布到平台。
- **内容访问控制**:
  - `权限验证网关`: 后端的核心服务，在用户请求访问具体课程内容时，它会实时向 The Graph 发送查询，验证请求者的钱包地址是否拥有该课程的链上所有权凭证，实现精准、可靠的“内容门控”。

### **3.2 选修功能模块 (未来扩展)**

- **高级经济系统**:
  - **[选修]** `YD币回兑通道`: 允许作者将课程收入（YD 币）按固定汇率兑换回主流资产（如 ETH 或 USDT），完成经济闭环。
- **DeFi 集成**:
  - **[选修]** `质押理财模块`: 集成 AAVE V3 等主流 DeFi 协议，为创作者提供一个将其平台收入进行再投资的渠道，以获取额外的理财收益。

---

### **4. 经济模型 (Tokenomics)**

平台的核心经济活动围绕其原生功能型代币 **YD (Yideng Token)** 展开。

**4.1 代币分配**
根据项目规划，YD 代币的总量和初始分配如下：

- **团队 (锁仓释放)**: 20% (200,000 YD)，用于创始团队激励。
- **投资人 (种子/私募)**: 15% (150,000 YD)，用于项目融资。
- **学员空投 & 奖励**: 25% (250,000 YD)，用于学习激励和早期用户吸引。
- **生态 & 营销**: 20% (200,000 YD)，用于推广合作与生态建设。
- **二级市场流动性池**: 20% (200,000 YD)，用于提供交易对。

**4.2 代币功用**

- **交易媒介**: YD 是平台内购买课程的唯一支付方式。
- **激励**: 通过空投和奖励，激励用户学习和参与社区活动。
- **治理 (未来)**: 在项目进入社区治理阶段后，YD 代币将作为投票权，决定平台的发展方向。

---

### **5. 核心交互流程拆解 (Core Interaction Flows)**

- **创建课程流程**:
  1. **前端**: 作者在作者平台填写课程信息（标题、描述、价格）。
  2. **后端**: 前端将课程内容发送至后端，后端存入 PostgreSQL 数据库并生成一个唯一的课程 UUID。
  3. **前端**: 后端将 UUID 返回给前端，前端调用用户钱包（MetaMask）发起交易，将课程 UUID 和价格提交给`CoursePlatform`合约。
  4. **链上**: 交易成功后，课程元数据（创建者、价格）和所有权（创建者拥有）被记录上链，并发出`CourseCreated`事件，被 The Graph 捕获。
- **购买课程流程**:
  1. **前端**: 学生在课程页面点击“购买”。
  2. **链上 (Approve)**: 前端调用`YDToken`合约的`approve`函数，请求用户授权`CoursePlatform`合约可操作其账户中等于课程价格的 YD 代币。
  3. **链上 (Purchase)**: 用户授权后，前端调用`CoursePlatform`合约的`purchaseCourse`函数。
  4. **合约交互**: `CoursePlatform`合约调用`YDToken`合约的`transferFrom`方法，将 YD 代币从学生账户直接转移到课程作者账户。同时，更新链上所有权记录，并将学生地址加入到课程的购买者列表中。

---

### **6. 技术架构与实现方案 (Technical Architecture & Implementation)**

- **技术选型**
  - **智能合约**: **Solidity**, **Hardhat**, **OpenZeppelin Contracts**。
  - **数据索引**: **The Graph Protocol**。
  - **后端**: **Node.js**, **Express.js**, **PostgreSQL**。
  - **前端**: **React**, **TypeScript**, **Tailwind CSS**, **Ethers.js,Wagmi 等**。
  - **钱包**: **MetaMask**。
- **智能合约设计 (`CoursePlatform.sol`)**
  - `mapping(uint256 => Course) public courses;`: 存储课程元数据（创建者、价格）。
  - `mapping(uint256 => mapping(address => bool)) public courseOwnership;`: 存储课程所有权。
  - `createCourse(uint256 _courseId, uint256 _priceInYd)`: 创建课程函数。
  - `purchaseCourse(uint256 _courseId)`: 购买课程函数。
  - `event CourseCreated(...)`, `event CoursePurchased(...)`: 用于被 The Graph 索引的事件。
- **后端与数据库设计**
  - API 将遵循 RESTful 风格，主要提供`/courses`（内容创建）和`/courses/{uuid}`（内容获取，需权限验证）等接口。
  - PostgreSQL 将设计`users`和`courses`两个核心表，通过课程 UUID 与链上数据关联。

---

### **7. 开发路线图与里程碑 (Roadmap & Milestones)**

- **阶段一: 核心 MVP 交付 (预计 6 周)**
  - **里程碑 1**: 完成`YDToken`（仅含 ETH-\>YD 兑换）和`CoursePlatform`合约的开发、审计与部署。
  - **里程碑 2**: 完成后端数据库和核心 API 的搭建。
  - **里程碑 3**: 完成 The Graph 子图的部署，并与后端成功对接。
  - **里程碑 4**: **实现用户可以完整地走通“创建课程 -\> 兑换 YD 币 -\> 购买课程 -\> 访问内容”的核心 MVP 流程**。此阶段结束时，我们将拥有一个可在测试网上公开演示、价值闭环的产品。
- **阶段二: 经济闭环与生态扩展 (MVP 成功后启动)**
  - **里程碑 1**: **[选修]** 上线 YD 到 ETH/USDT 的回兑功能，完成平台的经济闭环。
  - **里程碑 2**: **[选修]** 集成 AAVE 的 DeFi 理财模块，为创作者提供增值服务。
  - **里程碑 3**: 引入课程评价、问答等社区功能。
  - **里程碑 4**: 探索发行课程完成凭证（NFT），构建链上学习履历。

---

### **8. 未来展望 (Future Outlook)**

Web3 大学的征程始于一个功能精炼的课程市场，但其终点是一个繁荣的、去中心化的知识生态。未来，我们将探索：

- **去中心化治理 (DAO)**: 让 YD 代币持有者可以通过投票，共同决定平台的发展方向和关键参数。
- **链上证书 (NFTs)**: 为完成课程的学生颁发不可篡改的 NFT 证书，作为其技能的永久、可验证的证明。
- **知识图谱与社交金融**: 将课程、作者和学生之间的关系构建成一个去中心化的知识图谱，并结合社交金融（SocialFi）的元素，激励高质量的互动与知识分享。
